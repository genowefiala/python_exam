
import os, pwd, grp, stat, subprocess

file_list = ["group_only.txt","public_knowledge.txt","secret.txt","secret.txt.pgp","wiki.txt"]

try:
        for files in file_list:
                if os.path.isfile(files):
                        continue
                else: 
                        os.mknod(files)

        file1 = "group_only.txt"
        permission1 =0o60

        file2 = "public_knowledge.txt"
        permission2 =0o644

        file3 = "secret.txt"
        permission3 = 0o600

        file4 = "secret.txt.pgp"
        permission4 = 0o644

        file5 = "wiki.txt"
        permission5 = 0o777

        subprocess.call(["groupadd","wheel"]) 
        
#check file 1
        st = os.stat(file1)
        oct_perm = oct(st.st_mode)
        print "file 1:", oct_perm

        if oct_perm == 60:
                print "Permission is correct"
        else:
                os.chmod(file1, permission1)

        if os.stat(file1).st_uid == "root" and os.stat(file1).st_gid == "wheel":
                print "Ownership is correct"
        else:
                uid = pwd.getpwnam("root").pw_uid
                gid = grp.getgrnam("wheel").gr_gid
                os.chown("/root/permissions/group_only.txt", uid, gid)
                
                
#check file 2 
        st = os.stat(file2)
        oct_perm = oct(st.st_mode)
        print "file 2:", oct_perm

        if oct_perm == 644:
                print "Permission is correct"
        else:
                os.chmod(file2, permission2)

        if os.stat(file2).st_uid == "root" and os.stat(file2).st_gid == "root":
                print "Ownership is correct"
        else:
                uid = pwd.getpwnam("root").pw_uid
                gid = grp.getgrnam("root").gr_gid
                os.chown("/root/permissions/public_knowledge.txt", uid, gid)
 
#check file 3 
        st = os.stat(file3)
        oct_perm = oct(st.st_mode)
        print "file 3:", oct_perm

        if oct_perm == 600:
                print "Permission is correct"
        else:
                os.chmod(file3, permission3)

        if os.stat(file3).st_uid == "root" and os.stat(file3).st_gid == "root":
                print "Ownership is correct"
        else:
                uid = pwd.getpwnam("root").pw_uid
                gid = grp.getgrnam("root").gr_gid
                os.chown("/root/permissions/secret.txt", uid, gid)
                
#check file 4 
        st = os.stat(file4)
        oct_perm = oct(st.st_mode)
        print "file 4:", oct_perm

        if oct_perm == 644:
                print "Permission is correct"
        else:
                os.chmod(file4, permission4)

        if os.stat(file4).st_uid == "root" and os.stat(file4).st_gid == "root":
                print "Ownership is correct"
        else:
                uid = pwd.getpwnam("root").pw_uid
                gid = grp.getgrnam("root").gr_gid
                os.chown("/root/permissions/secret.txt.pgp", uid, gid)
                

#check file 5
        st = os.stat(file5)
        oct_perm = oct(st.st_mode)
        print "file 5:", oct_perm

        if oct_perm == 777:
                print "Permission is correct"
        else:
                os.chmod(file5, permission5)

        if os.stat(file5).st_uid == "nobody" and os.stat(file5).st_gid == "nogroup":
                print "Ownership is correct"
        else:
                uid = pwd.getpwnam("nobody").pw_uid
                gid = grp.getgrnam("nogroup").gr_gid
                os.chown("/root/permissions/wiki.txt", uid, gid)
except: 
        sys.exit(2)



                

                        




        
        
        
       
